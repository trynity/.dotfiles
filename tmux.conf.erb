# General
set -s escape-time 0 # fastest command sequences
set -s quiet on # disable various messages

# Rather than constraining window size to the maximum size of any
# client connected to the *session*, constrain window size to the
# maximum size of any client connected to *that window*. Much more
# reasonable. From: https://mutelight.org/practical-tmux
setw -g aggressive-resize on

# Use UTF-8
setw -g utf8 on
set -g status-utf8 on

# Set Command Prefix to Ctrl+A to be like screen
unbind C-b
set-option -g prefix C-a
bind C-a send-prefix

### Commands

# Split Windows
unbind -
bind - split-window -v
unbind |
bind | split-window -h

# Select Panes
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Resize Panes
bind H resize-pane -L 5
bind J resize-pane -D 5
bind K resize-pane -U 5
bind L resize-pane -R 5

# Swap Panes
unbind {
bind { swap-pane -D
unbind }
bind } swap-pane -U

# This breaks scrolling when we're SSHed
# unbind [
# bind [ previous-window
# unbind ]
# bind ] next-window

unbind r
bind r source-file ~/.tmux.conf \; display '~/.tmux.conf sourced'

# Ctrl+A S for a new SSH session
unbind S
bind S command-prompt -p ssh: "new-window -n %1 'ssh %1'"

# Terminal Emulation
set -g default-terminal "xterm-256color"

<% if OS.mac? %>
# Deal with MacOSX Issues
# https://github.com/ChrisJohnsen/tmux-MacOSX-pasteboard
if-shell 'command which -s "reattach-to-user-namespace"' 'set-option -g default-command "reattach-to-user-namespace -l ${SHELL}"'
<% end %>

# Enable mouse only if we're not on an SSH session
# if '[ -z $SSH_CONNECTION ]' 'setw -g mode-mouse on'
# if '[ -z $SSH_CONNECTION ]' 'set -g mouse-select-pane on'
# if '[ -z $SSH_CONNECTION ]' 'set -g mouse-resize-pane on'
# if '[ -z $SSH_CONNECTION ]' 'set -g mouse-select-window on'

#### COLOR

# Default Statusbar Colors
set-option -g status-bg colour235 #base02
set-option -g status-fg colour136 #yellow
set-option -g status-attr default

# Default Window Title Colors
set-window-option -g window-status-fg colour244
set-window-option -g window-status-bg default
#set-window-option -g window-status-attr dim

# Active Window Title Colors
set-window-option -g window-status-current-fg colour166 #orange
set-window-option -g window-status-current-bg default
#set-window-option -g window-status-current-attr bright

# Pane Border
set-option -g pane-border-fg colour235 #base02
set-option -g pane-active-border-fg colour240 #base01

# Message Text
set-option -g message-bg colour235 #base02
set-option -g message-fg colour166 #orange

# Pane Number Display
set-option -g display-panes-active-colour colour33 #blue
set-option -g display-panes-colour colour166 #orange

# Clock
set-window-option -g clock-mode-colour colour64 #green

#### DISPLAY

# Refresh the Status Bar every second
set -g status-interval 1000

# Session Titles
set -g set-titles on

# Unlimited Scroll History
set -g history-limit 100000

# Centre-align status tabs, like screen
# set -g status-justify centre

# Start Window and Pane Numbering at 1
set -g base-index 1
setw -g pane-base-index 1

# Rename Window to current program
setw -g automatic-rename on

# Renumber Windows when one is closed
set -g renumber-windows on
